program main
    use torontonian_samples
    use kinds

    implicit none

    real(wp)    :: covmat(8, 8), mean(8), tmp
    integer(ip) :: seed, n_samples, sample_out(1:10)

    seed = 454
    n_samples = 10
    mean = 0.d0

    ! define the covariance matrix
    covmat(1, :) = [  4.47205386d0,    -1.50240993d0,    -4.35834573d-01,  -2.81987340d-03,   &
                         3.75561217d-01,   1.38119245d-01,   1.43053389d0,    -1.08596120d0]
    covmat(2, :) = [ -1.50240993d0,     1.52794614d0,    -2.81987340d-03,   4.35834573d-01,   &
                         1.38119245d-01,  -3.75561217d-01,  -1.08596120d0,    -1.43053389d0]
    covmat(3, :) = [ -4.35834573d-01,  -2.81987340d-03,   7.75913047d-01,  -1.62284038d0,     &
                        -4.01198874d-01,  -2.48553519d-01,  -6.86083363d-02,   4.91946855d-02]
    covmat(4, :) = [ -2.81987340d-03,   4.35834573d-01,  -1.62284038d0,     5.22408695d0,     &
                        -2.48553519d-01,   4.01198874d-01,   4.91946855d-02,   6.86083363d-02]
    covmat(5, :) = [  3.75561217d-01,   1.38119245d-01,  -4.01198874d-01,  -2.48553519d-01,   &
                         5.29709825d0,     1.14132568d0,    -1.01548207d0,     8.15410152d-02]
    covmat(6, :) = [  1.38119245d-01,  -3.75561217d-01,  -2.48553519d-01,   4.01198874d-01,   &
                         1.14132568d0,     7.02901751d-01,   8.15410152d-02,   1.01548207d0]
    covmat(7, :) = [  1.43053389d0,    -1.08596120d0,    -6.86083363d-02,   4.91946855d-02,   &
                        -1.01548207d0,     8.15410152d-02,   1.25787657d0,     8.33238874d-01]
    covmat(8, :) = [ -1.08596120d0,    -1.43053389d0,     4.91946855d-02,   6.86083363d-02,   &
                         8.15410152d-02,   1.01548207d0,     8.33238874d-01,   4.74212343d0]

    call GenerateSample(covmat, mean, n_samples, seed, sample_out)
    write(*,*)sample_out

end program
